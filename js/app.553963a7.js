(function(){"use strict";var t={5475:function(t,e,r){r(2986),r(784);var n=r(6369),o=r(5996),a=r(9425);r(7024);n["default"].use(o.XG7),n["default"].use(a.X);var i=function(){var t=this,e=t._self._c;return e("b-container",{attrs:{fluid:""}},[e("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"success"}},[e("b-navbar-brand",{staticStyle:{width:"180px"},attrs:{to:"/"}},[t._v("物品管理系統")]),e("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),e("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[e("b-navbar-nav",{staticClass:"ml-auto mr-auto"},[e("b-nav-item",{attrs:{to:"/borrow"}},[t._v("借用物品")]),e("b-nav-item",{attrs:{to:"/return"}},[t._v("歸還物品")]),e("b-nav-item",{attrs:{to:"/user_list"}},[t._v("人員管理")]),e("b-nav-item",{attrs:{to:"/item_list"}},[t._v("物品管理")]),t.curuser?t._e():e("b-nav-item",{attrs:{to:"/login"}},[t._v("登入")])],1)],1),e("b-navbar-nav",[e("span",{staticStyle:{width:"130px"}}),t.curuser?e("b-nav-item",{on:{click:t.logout}},[t._v("登出")]):t._e(),e("b-nav-item",{attrs:{to:"/about"}},[t._v("關於")])],1)],1),e("router-view")],1)},s=[],u=r(3822),l={data(){return{}},computed:{...(0,u.rn)({curuser:t=>t.curuser})},methods:{async logout(){await this.$store.dispatch("logout"),this.$router.push("/login")}}},c=l,d=r(1001),m=(0,d.Z)(c,i,s,!1,null,"631581d5",null),f=m.exports,h=r(2631),p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"mt-5",attrs:{align:"center"}},[e("b-card",{staticClass:"mb-2",staticStyle:{"max-width":"20rem"},attrs:{title:"物品管理系統","img-src":"https://picsum.photos/600/300/?image=24","img-alt":"Image","img-top":"",tag:"article","border-variant":"info"}},[e("b-card-text",{staticClass:"desc"},[t._v(" 這是物品借用系統雛形，功能尚待測試，介面也有待進一步美化。 ")]),t.ready?e("div",[e("p",[t._v(t._s(t.ready))]),e("p",[e("b-button",{attrs:{variant:"success",to:"/login"}},[t._v("登入")])],1),e("p",[e("b-button",{on:{click:function(e){return t.updateData()}}},[t._v("重新下載資料")])],1)]):t._e()],1)],1)},b=[],v={data(){return{ready:null}},computed:{...(0,u.rn)({users:t=>t.users,items:t=>t.items})},async created(){this.users&&this.items?this.ready="準備就緒":await this.updateData()},methods:{async updateData(){try{await this.$store.dispatch("get_collection","users"),await this.$store.dispatch("get_collection","items"),await this.$store.dispatch("get_collection","borrows"),this.ready="已準備就緒",alert("資料下載完畢！")}catch(t){console.log("Error",t)}}}},g=v,w=(0,d.Z)(g,p,b,!1,null,"24256be0",null),y=w.exports,_=function(){var t=this,e=t._self._c;return e("div",{staticClass:"panel w-50"},[e("b-modal",{attrs:{title:t.info.title,"ok-only":""},model:{value:t.showInfo,callback:function(e){t.showInfo=e},expression:"showInfo"}},[t._v(" "+t._s(t.info.message)+" ")]),e("b-input",{staticClass:"mt-3",attrs:{placeholder:"Username/Email"},model:{value:t.user.email,callback:function(e){t.$set(t.user,"email",e)},expression:"user.email"}}),e("b-input",{staticClass:"mt-3",attrs:{type:"password",placeholder:"輸入密碼"},model:{value:t.user.password,callback:function(e){t.$set(t.user,"password",e)},expression:"user.password"}}),e("p",{attrs:{align:"center"}},[e("b-button",{staticClass:"mt-3",attrs:{variant:"info"},on:{click:t.login}},[t._v("登入")])],1)],1)},k=[],C={data(){return{showInfo:!1,info:{title:"",message:""},user:{email:"",password:""}}},computed:{...(0,u.rn)({curuser:t=>t.curuser,users:t=>t.users}),userlist(){return this.users?Array.from(Object.entries(this.users),(([t,e])=>Object.assign(e,{id:t}))):[]}},created(){this.curuser&&this.$router.push("/borrow")},methods:{checkValid(){if(""===this.user.realname||""===this.user.phone)return alert("Name/Phone should not be empty!"),!1;if(this.admin){if(""===this.user.username)return alert("Username should not be empty!"),!1;if(this.user.password.length<6)return alert("Password should be at least 6 chars!"),!1;if(""===this.user.password)return alert("Password should not be empty!"),!1;if(this.user.password!==this.user.repassword)return alert("Password should be same!"),!1}return!0},async login(){try{let e="",r=this.userlist.filter((t=>t.email==this.user.email));if(0==r.length){if(r=this.userlist.filter((t=>t.username==this.user.email)),0==r.length)return this.info={title:"登入失敗",message:"查無此使用者帳號"},void(this.showInfo=!0);e=r[0].email}try{await this.$store.dispatch("login",{email:e,password:this.user.password}),this.$router.push("/borrow")}catch(t){return this.info={title:"登入失敗",message:"帳號或密碼錯誤"},void(this.showInfo=!0)}}catch(t){console.log("Error",t)}}}},E=C,O=(0,d.Z)(E,_,k,!1,null,"5900bff9",null),x=O.exports;n["default"].use(h.Z);const j=[{path:"/",name:"home",component:y},{path:"/login",name:"login",component:x},{path:"/about",name:"about",component:()=>r.e(443).then(r.bind(r,3915))},{path:"/borrow",name:"borrow",component:()=>r.e(443).then(r.bind(r,733))},{path:"/return",name:"return",component:()=>r.e(443).then(r.bind(r,4201))},{path:"/item_add",name:"item_add",component:()=>r.e(443).then(r.bind(r,1785))},{path:"/user_add",name:"user_add",component:()=>r.e(443).then(r.bind(r,8738))},{path:"/user_list",name:"user_list",component:()=>r.e(443).then(r.bind(r,5771))},{path:"/item_list",name:"item_list",component:()=>r.e(443).then(r.bind(r,7607))},{path:"/qr_read",name:"qr_read",component:()=>r.e(443).then(r.bind(r,6322))},{path:"/qr_show",name:"qr_show",component:()=>r.e(443).then(r.bind(r,9549))}],I=new h.Z({mode:"history",base:"/baby_borrow/",routes:j});var P=I,A=r(5734);n["default"].use(u.ZP);const S=["users","items","borrows"],Z=()=>({users:null,items:null,borrows:null,curuser:null}),M={set_object(t,e){t[e.key]=e.value},insert_item(t,e){if(t[e.collection])t[e.collection][e.id]=e.value;else{let r={};r[e.id]=e.value,t[e.collection]=r}},update_item(t,e){t[e.collection]&&(t[e.collection][e.id]=e.value)},delete_item(t,e){t[e.collection]&&n["default"]["delete"](t[e.collection],e.id)}},T={async logout({state:t,commit:e}){t.curuser&&await A.mO.signOut(),e("set_object",{key:"curuser",value:null})},async login({commit:t},e){let r=await A.mO.signInWithEmailAndPassword(e.email,e.password);if(r){let e=r.user.uid,n=await A.Mx.collection("users").doc(e).get(),o=n.data();return o.id=e,t("set_object",{key:"curuser",value:o}),o}return console.log("FAIL"),!1},async get_collection({commit:t},e){let r={};try{let n=await A.Mx.collection(e).get();if(n.empty)return{};n.forEach((t=>r[t.id]=t.data())),S.includes(e)&&t("set_object",{key:e,value:r})}catch(n){console.log("Error",n)}return r},async update_item({commit:t},e){try{await A.Mx.collection(e.collection).doc(e.id).update(e.value),t("update_item",e)}catch(r){console.log("Error",r)}},async insert_item({commit:t},e){try{let r=await A.Mx.collection(e.collection).add(e.value);return console.log("COMMIT"),t("insert_item",{collection:e.collection,id:r.id,value:e.value}),r.id}catch(r){return console.log("Error",r),!1}},async delete_item({commit:t},e){try{await A.Mx.collection(e.collection).doc(e.id).delete(),t("delete_item",{collection:e.collection,id:e.id})}catch(r){console.log("Error",r)}}},$=new u.yh({state:Z,mutations:M,actions:T});var N=$;n["default"].config.productionTip=!1,new n["default"]({router:P,store:N,render:t=>t(f)}).$mount("#app")},5734:function(t,e,r){r.d(e,{Mx:function(){return i},mO:function(){return a}});var n=r(4552);r(8076),r(3753),r(4737);const o={apiKey:"AIzaSyD05CEV94R-7PpdN5iBQ6WZcILp4rWVguw",authDomain:"borrow-c68b0.firebaseapp.com",projectId:"borrow-c68b0",storageBucket:"borrow-c68b0.appspot.com",messagingSenderId:"742780752257",appId:"1:742780752257:web:295db2c6361fed839a9880",measurementId:"G-P3ZH6HWEFF"};n.Z.initializeApp(o);var a=n.Z.auth(),i=n.Z.firestore();n.Z.storage().ref()}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,r),a.exports}r.m=t,function(){r.amdD=function(){throw new Error("define cannot be used indirect")}}(),function(){r.amdO={}}(),function(){var t=[];r.O=function(e,n,o,a){if(!n){var i=1/0;for(c=0;c<t.length;c++){n=t[c][0],o=t[c][1],a=t[c][2];for(var s=!0,u=0;u<n.length;u++)(!1&a||i>=a)&&Object.keys(r.O).every((function(t){return r.O[t](n[u])}))?n.splice(u--,1):(s=!1,a<i&&(i=a));if(s){t.splice(c--,1);var l=o();void 0!==l&&(e=l)}}return e}a=a||0;for(var c=t.length;c>0&&t[c-1][2]>a;c--)t[c]=t[c-1];t[c]=[n,o,a]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){r.f={},r.e=function(t){return Promise.all(Object.keys(r.f).reduce((function(e,n){return r.f[n](t,e),e}),[]))}}(),function(){r.u=function(t){return"js/about.916825e7.js"}}(),function(){r.miniCssF=function(t){return"css/about.429e28e4.css"}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="borrow:";r.l=function(n,o,a,i){if(t[n])t[n].push(o);else{var s,u;if(void 0!==a)for(var l=document.getElementsByTagName("script"),c=0;c<l.length;c++){var d=l[c];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==e+a){s=d;break}}s||(u=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.setAttribute("data-webpack",e+a),s.src=n),t[n]=[o];var m=function(e,r){s.onerror=s.onload=null,clearTimeout(f);var o=t[n];if(delete t[n],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((function(t){return t(r)})),e)return e(r)},f=setTimeout(m.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=m.bind(null,s.onerror),s.onload=m.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),function(){r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){r.p="/baby_borrow/"}(),function(){var t=function(t,e,r,n){var o=document.createElement("link");o.rel="stylesheet",o.type="text/css";var a=function(a){if(o.onerror=o.onload=null,"load"===a.type)r();else{var i=a&&("load"===a.type?"missing":a.type),s=a&&a.target&&a.target.href||e,u=new Error("Loading CSS chunk "+t+" failed.\n("+s+")");u.code="CSS_CHUNK_LOAD_FAILED",u.type=i,u.request=s,o.parentNode.removeChild(o),n(u)}};return o.onerror=o.onload=a,o.href=e,document.head.appendChild(o),o},e=function(t,e){for(var r=document.getElementsByTagName("link"),n=0;n<r.length;n++){var o=r[n],a=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(a===t||a===e))return o}var i=document.getElementsByTagName("style");for(n=0;n<i.length;n++){o=i[n],a=o.getAttribute("data-href");if(a===t||a===e)return o}},n=function(n){return new Promise((function(o,a){var i=r.miniCssF(n),s=r.p+i;if(e(i,s))return o();t(n,s,o,a)}))},o={143:0};r.f.miniCss=function(t,e){var r={443:1};o[t]?e.push(o[t]):0!==o[t]&&r[t]&&e.push(o[t]=n(t).then((function(){o[t]=0}),(function(e){throw delete o[t],e})))}}(),function(){var t={143:0};r.f.j=function(e,n){var o=r.o(t,e)?t[e]:void 0;if(0!==o)if(o)n.push(o[2]);else{var a=new Promise((function(r,n){o=t[e]=[r,n]}));n.push(o[2]=a);var i=r.p+r.u(e),s=new Error,u=function(n){if(r.o(t,e)&&(o=t[e],0!==o&&(t[e]=void 0),o)){var a=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;s.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",s.name="ChunkLoadError",s.type=a,s.request=i,o[1](s)}};r.l(i,u,"chunk-"+e,e)}},r.O.j=function(e){return 0===t[e]};var e=function(e,n){var o,a,i=n[0],s=n[1],u=n[2],l=0;if(i.some((function(e){return 0!==t[e]}))){for(o in s)r.o(s,o)&&(r.m[o]=s[o]);if(u)var c=u(r)}for(e&&e(n);l<i.length;l++)a=i[l],r.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return r.O(c)},n=self["webpackChunkborrow"]=self["webpackChunkborrow"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=r.O(void 0,[998],(function(){return r(5475)}));n=r.O(n)})();
//# sourceMappingURL=app.553963a7.js.map